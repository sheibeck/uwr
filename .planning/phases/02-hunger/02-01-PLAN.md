---
phase: 02-hunger
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - spacetimedb/src/index.ts
  - spacetimedb/src/reducers/hunger.ts
  - spacetimedb/src/reducers/characters.ts
  - spacetimedb/src/reducers/combat.ts
  - spacetimedb/src/reducers/items.ts
  - spacetimedb/src/reducers/index.ts
  - spacetimedb/src/views/hunger.ts
  - spacetimedb/src/views/types.ts
  - spacetimedb/src/views/index.ts
autonomous: true

must_haves:
  truths:
    - "New characters start with hunger at 100 and no Well Fed buff"
    - "Hunger decays by 2 every 5 minutes via scheduled tick"
    - "Eating Well Fed food consumes the item and sets wellFedUntil, wellFedBuffType and wellFedBuffMagnitude on Hunger row"
    - "Eating Simple Rations (no Well Fed) consumes the item and applies a +1 HP × 10 tick regen HoT"
    - "str and dex Well Fed bonuses add flat damage to auto-attack and ability damage"
    - "Hunger reaching 0 causes no penalty"
    - "5 food items seeded: Simple Rations (consumable, vendor), Herb Broth, Roasted Roots, Traveler's Stew, Forager's Salad (all food slot, craftable)"
    - "2 new resource items seeded: Wild Berries and Root Vegetable, with terrain pool entries"
    - "4 recipe templates seeded for the crafted meals using Wild Berries and Root Vegetable"
    - "Deleting a character removes its Hunger row"
  artifacts:
    - path: "spacetimedb/src/index.ts"
      provides: "Hunger table, HungerDecayTick table, ItemTemplate extended with wellFedDurationMicros/wellFedBuffType/wellFedBuffMagnitude, food item templates seeded, resource templates extended with Wild Berries and Root Vegetable, terrain pools updated, recipe templates for 4 crafted meals, ensureHungerDecayScheduled"
      contains: "name: 'hunger'"
    - path: "spacetimedb/src/reducers/hunger.ts"
      provides: "eat_food reducer, decay_hunger scheduled reducer, registerHungerReducers export"
      exports: ["registerHungerReducers"]
    - path: "spacetimedb/src/reducers/characters.ts"
      provides: "Hunger row insert in create_character, Hunger row cleanup in delete_character"
      contains: "ctx.db.hunger.insert"
    - path: "spacetimedb/src/reducers/combat.ts"
      provides: "Well Fed str and dex flat bonuses in auto-attack damage formula"
      contains: "wellFedBuffType"
    - path: "spacetimedb/src/reducers/items.ts"
      provides: "Simple Rations HoT branch in use_item, wellFedBuffType/wellFedBuffMagnitude fields in create_item_template insert"
      contains: "simple_rations"
    - path: "spacetimedb/src/views/hunger.ts"
      provides: "my_hunger view returning active character's hunger row"
      exports: ["registerHungerViews"]
  key_links:
    - from: "spacetimedb/src/reducers/hunger.ts"
      to: "spacetimedb/src/index.ts"
      via: "Hunger table and HungerDecayTick table imports through deps"
      pattern: "ctx\\.db\\.hunger"
    - from: "spacetimedb/src/reducers/characters.ts"
      to: "spacetimedb/src/index.ts"
      via: "Hunger row insert after character creation"
      pattern: "ctx\\.db\\.hunger\\.insert"
    - from: "spacetimedb/src/reducers/combat.ts"
      to: "spacetimedb/src/index.ts"
      via: "Hunger row lookup for Well Fed check in auto-attack"
      pattern: "ctx\\.db\\.hunger\\.characterId\\.filter"
    - from: "spacetimedb/src/index.ts executeAbilityAction"
      to: "Hunger table"
      via: "Well Fed bonus added to ability damage path"
      pattern: "wellFedBuffType"
---

<objective>
Implement the complete hunger system backend: Hunger table, HungerDecayTick scheduled table, ItemTemplate extension for food items, eat_food reducer, decay_hunger reducer, Well Fed combat integration in both auto-attack and ability damage, my_hunger view, Simple Rations HoT in use_item, new resource items (Wild Berries + Root Vegetable), and food item template + recipe template seeding. Publish with --clear-database -y and regenerate client bindings.

Purpose: This is the server-authoritative foundation for the hunger feature. All combat, consumption, and decay logic must be correct before frontend work begins.
Output: Published SpacetimeDB module with working hunger system, regenerated client bindings.
</objective>

<execution_context>
@C:/Users/Dell/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/Dell/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-hunger/02-RESEARCH.md
@spacetimedb/src/index.ts
@spacetimedb/src/reducers/characters.ts
@spacetimedb/src/reducers/combat.ts
@spacetimedb/src/reducers/items.ts
@spacetimedb/src/reducers/index.ts
@spacetimedb/src/views/effects.ts
@spacetimedb/src/views/types.ts
@spacetimedb/src/views/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Schema, reducers, views, and data seeding</name>
  <files>
    spacetimedb/src/index.ts
    spacetimedb/src/reducers/hunger.ts
    spacetimedb/src/reducers/characters.ts
    spacetimedb/src/reducers/items.ts
    spacetimedb/src/reducers/index.ts
    spacetimedb/src/views/hunger.ts
    spacetimedb/src/views/types.ts
    spacetimedb/src/views/index.ts
  </files>
  <action>
**A. Add Hunger table to `spacetimedb/src/index.ts` (before schema() export at line 1194):**

```typescript
const Hunger = table(
  {
    name: 'hunger',
    indexes: [{ name: 'characterId', algorithm: 'btree', columns: ['characterId'] }],
  },
  {
    id: t.u64().primaryKey().autoInc(),
    characterId: t.u64(),
    currentHunger: t.u64(),       // 0-100; 0 has no penalty (REQ-015)
    wellFedUntil: t.timestamp(),  // epoch/current time if not well fed; future if well fed
    wellFedBuffType: t.string(),  // '' when not well fed; 'str' | 'dex' | 'mana_regen' | 'stamina_regen'
    wellFedBuffMagnitude: t.u64(), // 0 when not well fed; set when eating food
  }
);
```

**B. Add HungerDecayTick scheduled table to `spacetimedb/src/index.ts` (near HealthRegenTick at line 1012):**

```typescript
const HungerDecayTick = table(
  { name: 'hunger_decay_tick', scheduled: 'decay_hunger' },
  { scheduledId: t.u64().primaryKey().autoInc(), scheduledAt: t.scheduleAt() }
);
```

**C. Add both tables to schema() export (line 1194).** Add `Hunger` and `HungerDecayTick` to the `schema(...)` call alongside `HealthRegenTick`.

**D. Extend ItemTemplate (line 264) with three new fields at the end of the columns object:**

```typescript
wellFedDurationMicros: t.u64(),  // 0 for non-food items
wellFedBuffType: t.string(),     // '' for non-food items; 'str' | 'dex' | 'mana_regen' | 'stamina_regen'
wellFedBuffMagnitude: t.u64(),   // 0 for non-food items
```

CRITICAL: These go in the COLUMNS (second argument), NOT in OPTIONS. All existing `ensureStarterItemTemplates` upserts (line 3128+) must include `wellFedDurationMicros: 0n, wellFedBuffType: '', wellFedBuffMagnitude: 0n` for non-food items to avoid missing property errors on compile.

**E. Update `create_item_template` reducer in `spacetimedb/src/reducers/items.ts`:**

In `items.ts`, find the `create_item_template` reducer (~line 90) where `ctx.db.itemTemplate.insert(...)` is called. Add the three new required fields:

```typescript
ctx.db.itemTemplate.insert({
  // ... existing fields ...
  wellFedDurationMicros: 0n,
  wellFedBuffType: '',
  wellFedBuffMagnitude: 0n,
});
```

Without these fields the TypeScript compiler will fail with a missing property error.

**F. Add `ensureFoodItemTemplates` function in `index.ts` (after `ensureResourceItemTemplates`):**

Seed 4 Well Fed food templates using `upsertItemTemplateByName` (same pattern as ensureStarterItemTemplates). These use `slot: 'food'` to distinguish from consumables:

| Name | slot | tier | vendorValue | wellFedDurationMicros | wellFedBuffType | wellFedBuffMagnitude | stackable |
|------|------|------|-------------|----------------------|-----------------|---------------------|-----------|
| Herb Broth | food | 1n | 3n | 2_700_000_000n (45min) | 'mana_regen' | 4n | true |
| Roasted Roots | food | 1n | 3n | 2_700_000_000n (45min) | 'str' | 2n | true |
| Traveler's Stew | food | 1n | 3n | 2_700_000_000n (45min) | 'stamina_regen' | 4n | true |
| Forager's Salad | food | 1n | 3n | 2_700_000_000n (45min) | 'dex' | 2n | true |

All other stats (strBonus, dexBonus, etc.) = 0n. Set armorType: 'none', rarity: 'common', requiredLevel: 1n, allowedClasses: 'any', isJunk: false.

Note: Simple Rations stays as `slot: 'consumable'` (already seeded in ensureResourceItemTemplates). These 4 are NEW items with `slot: 'food'`.

Call `ensureFoodItemTemplates(ctx)` from `syncAllContent` after `ensureResourceItemTemplates`.

**G. Add `ensureHungerDecayScheduled` function (near `ensureHealthRegenScheduled` at line 4244):**

```typescript
const HUNGER_DECAY_INTERVAL_MICROS = 300_000_000n; // 5 minutes

function ensureHungerDecayScheduled(ctx: any) {
  if (!tableHasRows(ctx.db.hungerDecayTick.iter())) {
    ctx.db.hungerDecayTick.insert({
      scheduledId: 0n,
      scheduledAt: ScheduleAt.time(ctx.timestamp.microsSinceUnixEpoch + HUNGER_DECAY_INTERVAL_MICROS),
    });
  }
}
```

Call it from both `spacetimedb.init()` (line 5611) and `spacetimedb.clientConnected()` (line 5621) alongside the other ensure* calls.

**H. Create `spacetimedb/src/reducers/hunger.ts`:**

Export `registerHungerReducers(deps)` that defines two reducers:

1. `decay_hunger` (scheduled reducer) — iterates all Hunger rows via `ctx.db.hunger.iter()`, decrements `currentHunger` by 2 (floor at 0). Reschedules next tick. Pattern from `regen_health`.

```typescript
spacetimedb.reducer('decay_hunger', { arg: HungerDecayTick.rowType }, (ctx: any) => {
  for (const hunger of ctx.db.hunger.iter()) {
    if (hunger.currentHunger <= 0n) continue;
    const next = hunger.currentHunger > 2n ? hunger.currentHunger - 2n : 0n;
    ctx.db.hunger.id.update({ ...hunger, currentHunger: next });
  }
  ctx.db.hungerDecayTick.insert({
    scheduledId: 0n,
    scheduledAt: ScheduleAt.time(ctx.timestamp.microsSinceUnixEpoch + 300_000_000n),
  });
});
```

2. `eat_food` reducer — params: `{ characterId: t.u64(), itemInstanceId: t.u64() }`. Validates:
   - Character owned by sender (use `requireCharacterOwnedBy`)
   - Item instance exists and belongs to character
   - Item template slot is 'food'
   - Hunger row exists for character

   Consumes item (decrement quantity if >1, else delete instance). Then:
   - If `template.wellFedDurationMicros > 0n`: Set wellFedUntil = max(now + template.wellFedDurationMicros, current wellFedUntil). Set wellFedBuffType from template. Set wellFedBuffMagnitude from template. Append private event: "You eat the {name} and feel well fed."
   - If `template.wellFedDurationMicros === 0n`: (safety fallback for non-Well-Fed food slots) Just consume and return.

   NO combat guard (food usable mid-combat per research). Follow the `use_item` bandage pattern from `items.ts:829`.

**I. Register hunger reducers in `spacetimedb/src/reducers/index.ts`:**

Import `registerHungerReducers` from `./hunger` and call it in `registerReducers`.

**J. Add `Hunger` and `HungerDecayTick` to `reducerDeps` object (line 5662 in `index.ts`)** so hunger.ts receives them via deps. Also add `HUNGER_DECAY_INTERVAL_MICROS`, `ensureFoodItemTemplates`, and `ensureHungerDecayScheduled` to deps if needed. The hunger reducer needs: `spacetimedb`, `t`, `SenderError`, `ScheduleAt`, `Timestamp`, `Hunger` (table ref for rowType), `HungerDecayTick` (table ref), `requireCharacterOwnedBy`, `appendPrivateEvent`.

**K. Update `create_character` in `spacetimedb/src/reducers/characters.ts`:**

After `grantStarterItems(ctx, character)` at line 179, insert a Hunger row:

```typescript
ctx.db.hunger.insert({
  id: 0n,
  characterId: character.id,
  currentHunger: 100n,
  wellFedUntil: ctx.timestamp, // Current time = not well fed
  wellFedBuffType: '',
  wellFedBuffMagnitude: 0n,
});
```

**L. Update `delete_character` in `spacetimedb/src/reducers/characters.ts`:**

After the `characterEffect` cleanup, add Hunger cleanup:

```typescript
for (const row of ctx.db.hunger.characterId.filter(characterId)) {
  ctx.db.hunger.id.delete(row.id);
}
```

**M. Create `spacetimedb/src/views/hunger.ts`:**

Export `registerHungerViews(deps)`. Define `my_hunger` view following `my_character_effects` pattern (views/effects.ts):

```typescript
export const registerHungerViews = ({ spacetimedb, t, Hunger }: ViewDeps) => {
  spacetimedb.view(
    { name: 'my_hunger', public: true },
    t.array(Hunger.rowType),
    (ctx: any) => {
      const player = ctx.db.player.id.find(ctx.sender);
      if (!player || !player.activeCharacterId) return [];
      return [...ctx.db.hunger.characterId.filter(player.activeCharacterId)];
    }
  );
};
```

CRITICAL: Use `.filter()` on the btree index — NOT `.iter()`. Views cannot scan tables.

**N. Add `Hunger` to ViewDeps in `spacetimedb/src/views/types.ts`:**

Add `Hunger: any;` to the ViewDeps type.

**O. Register hunger views in `spacetimedb/src/views/index.ts`:**

Import `registerHungerViews` from `./hunger` and call it in `registerViews`.

**P. Add `Hunger` to the viewDeps object in `index.ts`** (search for where viewDeps is constructed and registerViews is called — near reducerDeps).

**Q. Add Wild Berries and Root Vegetable to `ensureResourceItemTemplates` in `index.ts`:**

In the `resources` array (line ~3320), add two entries before the `for` loop:

```typescript
{ name: 'Wild Berries', slot: 'resource', vendorValue: 1n },
{ name: 'Root Vegetable', slot: 'resource', vendorValue: 1n },
```

These follow the same insert pattern as existing resources (all 0n stat bonuses, tier: 1n, stackable: true, isJunk: false, etc.). The new fields `wellFedDurationMicros: 0n, wellFedBuffType: '', wellFedBuffMagnitude: 0n` must also be included (since ItemTemplate now requires them).

**R. Add Wild Berries and Root Vegetable to terrain pools in `getGatherableResourceTemplates` (~line 3061):**

In the `pools` object, add entries to existing terrain arrays:

```typescript
woods: [
  // ... existing entries ...
  { name: 'Wild Berries', weight: 3n, timeOfDay: 'any' },  // NEW
],
plains: [
  // ... existing entries ...
  { name: 'Wild Berries', weight: 2n, timeOfDay: 'day' },   // NEW
  { name: 'Root Vegetable', weight: 3n, timeOfDay: 'any' }, // NEW
],
```

**S. Implement Simple Rations HoT in `use_item` in `spacetimedb/src/reducers/items.ts`:**

After the `basic_poultice` branch (~line 855), add a `simple_rations` branch:

```typescript
if (itemKey === 'simple_rations') {
  const existingEffect = [...ctx.db.characterEffect.by_character.filter(character.id)].find(
    (effect) => effect.effectType === 'regen' && effect.sourceAbility === 'Simple Rations'
  );
  if (existingEffect) {
    ctx.db.characterEffect.id.delete(existingEffect.id);
  }
  ctx.db.characterEffect.insert({
    id: 0n,
    characterId: character.id,
    effectType: 'regen',
    magnitude: 1n,         // +1 HP per tick
    roundsRemaining: 10n,  // 10 ticks × 3s = 30s total healing
    sourceAbility: 'Simple Rations',
  });
  setCooldown(CONSUMABLE_COOLDOWN_MICROS);
  appendPrivateEvent(
    ctx,
    character.id,
    character.ownerUserId,
    'heal',
    'You eat the simple rations and feel a little better.'
  );
  return;
}
```

**T. Add 4 food recipes to `ensureRecipeTemplates` in `index.ts`:**

At the end of `ensureRecipeTemplates`, after the existing recipes, look up the new templates and add calls to `addRecipe`:

```typescript
const wildBerries = findItemTemplateByName(ctx, 'Wild Berries');
const rootVegetable = findItemTemplateByName(ctx, 'Root Vegetable');
const herbBroth = findItemTemplateByName(ctx, 'Herb Broth');
const roastedRoots = findItemTemplateByName(ctx, 'Roasted Roots');
const travelerStew = findItemTemplateByName(ctx, 'Traveler\'s Stew');
const foragerSalad = findItemTemplateByName(ctx, 'Forager\'s Salad');

// Food recipes — ingredients: Wild Berries and Root Vegetable (new gatherable resources)
addRecipe({
  key: 'herb_broth',
  name: 'Herb Broth',
  output: herbBroth,
  outputCount: 1n,
  req1: wildBerries,
  req1Count: 2n,
  req2: clearWater,       // Clear Water already looked up at top of function
  req2Count: 1n,
});
addRecipe({
  key: 'roasted_roots',
  name: 'Roasted Roots',
  output: roastedRoots,
  outputCount: 1n,
  req1: rootVegetable,
  req1Count: 2n,
  req2: salt,             // Salt already looked up at top of function
  req2Count: 1n,
});
addRecipe({
  key: 'travelers_stew',
  name: "Traveler's Stew",
  output: travelerStew,
  outputCount: 1n,
  req1: rootVegetable,
  req1Count: 1n,
  req2: rawMeat,          // Raw Meat already looked up at top of function
  req2Count: 1n,
});
addRecipe({
  key: 'foragers_salad',
  name: "Forager's Salad",
  output: foragerSalad,
  outputCount: 1n,
  req1: wildBerries,
  req1Count: 1n,
  req2: herbs,            // Herbs already looked up at top of function
  req2Count: 1n,
});
```

Note: `clearWater`, `salt`, `rawMeat`, and `herbs` are already looked up in the existing `ensureRecipeTemplates` code at the top of the function. Reuse those variables.
  </action>
  <verify>
Run `spacetime publish uwr --clear-database -y --project-path spacetimedb`. Module should compile and publish without errors. Then run `spacetime generate --lang typescript --out-dir src/module_bindings --project-path spacetimedb` to regenerate bindings. Verify generated bindings include `myHunger` table, `eatFood` reducer, and `ItemTemplate` row type includes `wellFedDurationMicros`, `wellFedBuffType`, and `wellFedBuffMagnitude` fields.
  </verify>
  <done>
Module published with Hunger table, HungerDecayTick, extended ItemTemplate (3 new food fields), 4 Well Fed food templates seeded (Herb Broth, Roasted Roots, Traveler's Stew, Forager's Salad), Simple Rations HoT in use_item, Wild Berries + Root Vegetable resources added to pools, 4 food recipes seeded, eat_food and decay_hunger reducers working, my_hunger view registered, create_character inserts Hunger row, delete_character cleans up Hunger row. Client bindings regenerated and committed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Well Fed combat integration (auto-attack and ability damage)</name>
  <files>
    spacetimedb/src/reducers/combat.ts
    spacetimedb/src/index.ts
  </files>
  <action>
**A. Add Well Fed bonus to auto-attack damage in `spacetimedb/src/reducers/combat.ts` (line 1607-1612):**

The current auto-attack damage formula at line 1607 is:
```typescript
const damage =
  5n + character.level + weapon.baseDamage + (weapon.dps / 2n) +
  sumEnemyEffect(ctx, combat.id, 'damage_taken', currentEnemy.id);
```

Replace with:
```typescript
const hungerRow = [...ctx.db.hunger.characterId.filter(character.id)][0] ?? null;
const nowMicros = ctx.timestamp.microsSinceUnixEpoch;
const isWellFed = hungerRow && hungerRow.wellFedUntil.microsSinceUnixEpoch > nowMicros;
// str and dex buffs apply as flat damage bonuses in combat (Tier 1 implementation)
const wellFedDmgBonus = isWellFed && (hungerRow.wellFedBuffType === 'str' || hungerRow.wellFedBuffType === 'dex')
  ? hungerRow.wellFedBuffMagnitude
  : 0n;
const baseDamage =
  5n + character.level + weapon.baseDamage + (weapon.dps / 2n) +
  sumEnemyEffect(ctx, combat.id, 'damage_taken', currentEnemy.id);
const damage = baseDamage + wellFedDmgBonus;
```

Note: `nowMicros` may already be declared in the surrounding scope (check line ~1595). If so, reuse it. Do NOT re-declare. Also check that `ctx.db.hunger` is accessible — if Hunger is not in reducerDeps for combat.ts, add it.

**B. Add Well Fed bonus to ability damage in `spacetimedb/src/index.ts` (the `executeAbilityAction` function, around line 1833):**

After `const damageUp = sumCharacterEffect(ctx, character.id, 'damage_up');`, add:

```typescript
const abilityHungerRow = [...ctx.db.hunger.characterId.filter(character.id)][0] ?? null;
const abilityNowMicros = ctx.timestamp.microsSinceUnixEpoch;
const abilityIsWellFed = abilityHungerRow &&
  abilityHungerRow.wellFedUntil.microsSinceUnixEpoch > abilityNowMicros;
// str and dex buffs apply as flat bonus to ability damage
const wellFedAbilityBonus = abilityIsWellFed &&
  (abilityHungerRow.wellFedBuffType === 'str' || abilityHungerRow.wellFedBuffType === 'dex')
  ? abilityHungerRow.wellFedBuffMagnitude
  : 0n;
const totalDamageUp = damageUp + wellFedAbilityBonus;
```

Then use `totalDamageUp` instead of `damageUp` in the `executeAbilityAction` call or wherever `damageUp` flows into the damage calculation. Trace the exact usage to make the substitution cleanly.

**C. mana_regen and stamina_regen buffs — apply in decay_hunger tick:**

In `hunger.ts` decay_hunger reducer, after decrementing hunger for each character, check if the character has an active mana_regen or stamina_regen Well Fed buff and apply restoration:

```typescript
for (const hunger of ctx.db.hunger.iter()) {
  if (hunger.currentHunger <= 0n) continue;
  const next = hunger.currentHunger > 2n ? hunger.currentHunger - 2n : 0n;
  let updatedHunger = { ...hunger, currentHunger: next };

  // Apply regen buffs on each decay tick
  if (hunger.wellFedUntil.microsSinceUnixEpoch > ctx.timestamp.microsSinceUnixEpoch) {
    const character = ctx.db.character.id.find(hunger.characterId);
    if (character) {
      if (hunger.wellFedBuffType === 'stamina_regen') {
        // Restore bonus stamina — check Character row has currentStamina/staminaMax fields
        // If field exists: const newStamina = character.currentStamina + hunger.wellFedBuffMagnitude;
        //                  ctx.db.character.id.update({ ...character, currentStamina: newStamina > character.staminaMax ? character.staminaMax : newStamina });
        // If fields don't exist: leave this as a TODO comment and skip
      }
      if (hunger.wellFedBuffType === 'mana_regen') {
        // Restore bonus mana — check Character row has currentMana/manaMax fields
        // If fields exist: similar pattern to stamina above
        // If fields don't exist: leave this as a TODO comment and skip
      }
    }
  }

  ctx.db.hunger.id.update(updatedHunger);
}
```

IMPORTANT: Read the Character table schema before implementing. If `currentStamina`/`staminaMax` and `currentMana`/`manaMax` fields exist on the Character row, implement the restoration. If they don't exist, add a `// TODO: implement when mana/stamina fields added to Character` comment and proceed. The buff type will still display correctly in the UI even if the regen effect is pending.

CRITICAL: Do NOT use `Date.now()` — use `ctx.timestamp.microsSinceUnixEpoch` throughout.
  </action>
  <verify>
Republish module: `spacetime publish uwr --clear-database -y --project-path spacetimedb`. Check `spacetime logs uwr` for no errors. Create a character, verify Hunger row created at 100. Test: use admin tools or reducers to set wellFedUntil to a future time with wellFedBuffType='str' and wellFedBuffMagnitude=2n — enter combat — verify damage is 2 higher than without the buff. Regenerate bindings: `spacetime generate --lang typescript --out-dir src/module_bindings --project-path spacetimedb`.
  </verify>
  <done>
Auto-attack damage at combat.ts includes Well Fed str/dex flat bonus. Ability damage in index.ts includes Well Fed str/dex flat bonus. mana_regen and stamina_regen applied in decay tick (or documented as TODO if Character lacks those fields). Module published and bindings regenerated.
  </done>
</task>

</tasks>

<verification>
1. Module publishes without errors (all new tables, reducers, views compile)
2. `spacetime logs uwr` shows no runtime errors
3. Creating a character inserts a Hunger row with currentHunger=100, wellFedUntil=creation time, wellFedBuffType='', wellFedBuffMagnitude=0
4. 4 Well Fed food templates exist: Herb Broth (mana_regen +4), Roasted Roots (str +2), Traveler's Stew (stamina_regen +4), Forager's Salad (dex +2), all 45min
5. Simple Rations is a craftable consumable with use_item applying +1 HP × 10 tick regen HoT
6. Wild Berries and Root Vegetable appear in item_template table and in terrain gather pools (woods/plains and plains)
7. 4 food recipe templates exist for the crafted meals
8. HungerDecayTick fires every 5 minutes, decrementing hunger by 2
9. eat_food reducer consumes food item and sets wellFedUntil + wellFedBuffType + wellFedBuffMagnitude on Hunger row
10. Client bindings include myHunger view, eatFood reducer, updated ItemTemplate type with wellFedBuffType and wellFedBuffMagnitude
</verification>

<success_criteria>
- Hunger table, HungerDecayTick, extended ItemTemplate (wellFedDurationMicros/wellFedBuffType/wellFedBuffMagnitude) all in schema and published
- eat_food and decay_hunger reducers functional
- Simple Rations HoT implemented in use_item
- my_hunger view returns active character's hunger row
- Well Fed str/dex bonus integrated into BOTH auto-attack (combat.ts) AND ability damage (index.ts)
- 4 Well Fed food templates seeded with balanced Tier 1 values (all 45 min, all Tier 1)
- Wild Berries and Root Vegetable seeded as resources with terrain pool entries
- 4 food recipe templates seeded (usable with existing craft_recipe reducer)
- create_character creates Hunger row; delete_character cleans it up
- Client bindings regenerated with all new types/reducers/views
</success_criteria>

<output>
After completion, create `.planning/phases/02-hunger/02-01-SUMMARY.md`
</output>
