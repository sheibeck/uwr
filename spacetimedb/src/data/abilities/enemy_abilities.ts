import type { DamageType } from '../ability_catalog.js';

export const ENEMY_ABILITIES = {
  // DoT abilities - physical damage
  poison_bite: {
    name: 'Poison Bite',
    castSeconds: 3n,
    cooldownSeconds: 20n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 70,
    aiRandomness: 15,
  },
  rending_bite: {
    name: 'Rending Bite',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 60,
    aiWeight: 55,
    aiRandomness: 15,
  },
  bleeding_shot: {
    name: 'Bleeding Shot',
    castSeconds: 1n,
    cooldownSeconds: 15n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 2n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 60,
    aiRandomness: 15,
  },
  bog_slime: {
    name: 'Bog Slime',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 15,
  },
  quick_nip: {
    name: 'Quick Nip',
    castSeconds: 1n,
    cooldownSeconds: 10n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 60,
    aiWeight: 45,
    aiRandomness: 20,
  },
  thorn_venom: {
    name: 'Thorn Venom',
    castSeconds: 2n,
    cooldownSeconds: 16n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  blood_drain: {
    name: 'Blood Drain',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 65,
    aiRandomness: 15,
  },
  rusty_bleed: {
    name: 'Rusty Bleed',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 55,
    aiRandomness: 15,
  },
  stone_cleave: {
    name: 'Stone Cleave',
    castSeconds: 1n,
    cooldownSeconds: 14n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 2n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 60,
    aiRandomness: 15,
  },

  // DoT abilities - magic damage
  ember_burn: {
    name: 'Ember Burn',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 15,
  },
  shadow_rend: {
    name: 'Shadow Rend',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 4n,
    rounds: 3n,
    power: 5n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 70,
    aiRandomness: 15,
  },
  scorching_snap: {
    name: 'Scorching Snap',
    castSeconds: 1n,
    cooldownSeconds: 14n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 60,
    aiRandomness: 15,
  },
  ember_spark: {
    name: 'Ember Spark',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 15,
  },
  searing_talon: {
    name: 'Searing Talon',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  shadow_bleed: {
    name: 'Shadow Bleed',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 65,
    aiRandomness: 15,
  },
  cinder_blight: {
    name: 'Cinder Blight',
    castSeconds: 2n,
    cooldownSeconds: 16n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 55,
    aiRandomness: 15,
  },
  molten_bleed: {
    name: 'Molten Bleed',
    castSeconds: 3n,
    cooldownSeconds: 20n,
    kind: 'dot',
    magnitude: 4n,
    rounds: 3n,
    power: 5n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 70,
    aiRandomness: 15,
  },

  // Debuff abilities - physical damage
  crushing_gore: {
    name: 'Crushing Gore',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'physical' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  quake_stomp: {
    name: 'Quake Stomp',
    castSeconds: 2n,
    cooldownSeconds: 22n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'physical' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 20,
  },

  // Debuff abilities - magic damage
  sapping_chant: {
    name: 'Sapping Chant',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  withering_hex: {
    name: 'Withering Hex',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 20,
  },
  mire_curse: {
    name: 'Mire Curse',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  ember_slam: {
    name: 'Ember Slam',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 20,
  },
  chill_touch: {
    name: 'Chill Touch',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  grave_shield_break: {
    name: 'Grave Shield Break',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  vault_crush: {
    name: 'Vault Crush',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 70,
    aiRandomness: 20,
  },
  soot_hex: {
    name: 'Soot Hex',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },

  // Heal abilities (new)
  shaman_heal: {
    name: 'Shaman Heal',
    castSeconds: 2n,
    cooldownSeconds: 15n,
    kind: 'heal',
    power: 5n,
    healPowerSplit: 0.6,
    hotDuration: 3n,
    targetRule: 'lowest_hp',
    aiChance: 70,
    aiWeight: 80,
    aiRandomness: 10,
  },
  dark_mend: {
    name: 'Dark Mend',
    castSeconds: 3n,
    cooldownSeconds: 20n,
    kind: 'heal',
    power: 6n,
    healPowerSplit: 0.5,
    hotDuration: 2n,
    targetRule: 'lowest_hp',
    aiChance: 65,
    aiWeight: 75,
    aiRandomness: 10,
  },

  // AoE damage abilities (new)
  flame_burst: {
    name: 'Flame Burst',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'aoe_damage',
    power: 6n,
    damageType: 'magic' as DamageType,
    targetRule: 'all_players',
    aiChance: 50,
    aiWeight: 75,
    aiRandomness: 15,
  },
  quake_wave: {
    name: 'Quake Wave',
    castSeconds: 3n,
    cooldownSeconds: 25n,
    kind: 'aoe_damage',
    power: 7n,
    damageType: 'physical' as DamageType,
    targetRule: 'all_players',
    aiChance: 45,
    aiWeight: 70,
    aiRandomness: 15,
  },

  // Night enemy abilities (quick-170)
  moth_dust: {
    name: 'Moth Dust',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 45,
    aiRandomness: 20,
  },
  plague_bite: {
    name: 'Plague Bite',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 20,
  },
  spectral_flame: {
    name: 'Spectral Flame',
    castSeconds: 2n,
    cooldownSeconds: 16n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 55,
    aiRandomness: 15,
  },
  shadow_pounce: {
    name: 'Shadow Pounce',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 2n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  drowning_grasp: {
    name: 'Drowning Grasp',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  soul_rend: {
    name: 'Soul Rend',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 65,
    aiRandomness: 15,
  },
  venom_fang: {
    name: 'Venom Fang',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 20,
  },
  sonic_screech: {
    name: 'Sonic Screech',
    castSeconds: 1n,
    cooldownSeconds: 14n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 55,
    aiRandomness: 20,
  },

  // Buff abilities (new)
  warchief_rally: {
    name: 'Warchief Rally',
    castSeconds: 2n,
    cooldownSeconds: 30n,
    kind: 'buff',
    effectType: 'damage_bonus',
    magnitude: 3n,
    rounds: 5n,
    targetRule: 'all_allies',
    aiChance: 60,
    aiWeight: 70,
    aiRandomness: 15,
  },
  bolster_defenses: {
    name: 'Bolster Defenses',
    castSeconds: 2n,
    cooldownSeconds: 25n,
    kind: 'buff',
    effectType: 'armor_up',
    magnitude: 3n,
    rounds: 4n,
    targetRule: 'all_allies',
    aiChance: 55,
    aiWeight: 65,
    aiRandomness: 15,
  },
};

// Maps enemy template names to their ability keys.
// This is the single source of truth for which enemies have which abilities.
// Adding a new enemy ability requires: (1) add entry to ENEMY_ABILITIES above,
// (2) add template mapping here â€” both in this same file.
export const ENEMY_TEMPLATE_ABILITIES: Record<string, string[]> = {
  'Bog Rat': ['poison_bite'],
  'Ember Wisp': ['ember_burn'],
  'Bandit': ['bleeding_shot'],
  'Blight Stalker': ['shadow_rend'],
  'Grave Acolyte': ['sapping_chant', 'dark_mend'],
  'Hexbinder': ['withering_hex', 'warchief_rally'],
  'Thicket Wolf': ['rending_bite'],
  'Marsh Croaker': ['bog_slime'],
  'Dust Hare': ['quick_nip'],
  'Ash Jackal': ['scorching_snap'],
  'Thorn Sprite': ['thorn_venom'],
  'Gloom Stag': ['crushing_gore'],
  'Mire Leech': ['blood_drain'],
  'Fen Witch': ['mire_curse', 'shaman_heal'],
  'Grave Skirmisher': ['rusty_bleed'],
  'Cinder Sentinel': ['ember_slam', 'flame_burst'],
  'Emberling': ['ember_spark'],
  'Frostbone Acolyte': ['chill_touch'],
  'Ridge Skirmisher': ['stone_cleave'],
  'Emberhawk': ['searing_talon'],
  'Basalt Brute': ['quake_stomp', 'quake_wave'],
  'Grave Servant': ['grave_shield_break'],
  'Alley Shade': ['shadow_bleed'],
  'Vault Sentinel': ['vault_crush'],
  'Sootbound Mystic': ['soot_hex', 'bolster_defenses'],
  'Ember Priest': ['cinder_blight'],
  'Ashforged Revenant': ['molten_bleed'],
  // Night enemies (quick-170)
  'Dusk Moth': ['moth_dust'],
  'Night Rat': ['plague_bite'],
  'Cinder Wraith': ['spectral_flame'],
  'Shadow Prowler': ['shadow_pounce'],
  'Bog Specter': ['drowning_grasp'],
  'Ashveil Phantom': ['soul_rend'],
  'Nightfang Viper': ['venom_fang'],
  'Gloomwing Bat': ['sonic_screech'],
};
