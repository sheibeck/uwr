import type { DamageType } from '../ability_catalog.js';

export const ENEMY_ABILITIES = {
  // DoT abilities - physical damage
  poison_bite: {
    name: 'Poison Bite',
    description: 'Venomous fangs sink deep, leaving a festering wound that seeps poison.',
    castSeconds: 3n,
    cooldownSeconds: 20n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 70,
    aiRandomness: 15,
  },
  rending_bite: {
    name: 'Rending Bite',
    description: 'Savage jaws tear flesh in ragged strips.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 60,
    aiWeight: 55,
    aiRandomness: 15,
  },
  bleeding_shot: {
    name: 'Bleeding Shot',
    description: 'A barbed arrow lodges in the wound, drawing blood with every movement.',
    castSeconds: 1n,
    cooldownSeconds: 15n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 2n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 60,
    aiRandomness: 15,
  },
  bog_slime: {
    name: 'Bog Slime',
    description: 'Caustic muck splatters and burns, eating through armor.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 15,
  },
  quick_nip: {
    name: 'Quick Nip',
    description: 'A darting snap that draws a thin line of blood.',
    castSeconds: 1n,
    cooldownSeconds: 10n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 60,
    aiWeight: 45,
    aiRandomness: 20,
  },
  thorn_venom: {
    name: 'Thorn Venom',
    description: 'Barbed thorns inject a slow-acting toxin that sears from within.',
    castSeconds: 2n,
    cooldownSeconds: 16n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  blood_drain: {
    name: 'Blood Drain',
    description: 'Lamprey-like tendrils latch on, siphoning lifeblood in dark pulses.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 65,
    aiRandomness: 15,
  },
  rusty_bleed: {
    name: 'Rusty Bleed',
    description: 'A jagged, corroded blade tears an ugly wound that refuses to close.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 55,
    aiRandomness: 15,
  },
  stone_cleave: {
    name: 'Stone Cleave',
    description: 'A massive stone edge cleaves downward, splitting armor and bone.',
    castSeconds: 1n,
    cooldownSeconds: 14n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 2n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 60,
    aiRandomness: 15,
  },

  // DoT abilities - magic damage
  ember_burn: {
    name: 'Ember Burn',
    description: 'Searing embers cling to flesh, igniting in waves of crackling flame.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 15,
  },
  shadow_rend: {
    name: 'Shadow Rend',
    description: 'Ribbons of living shadow slice through body and soul alike.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 4n,
    rounds: 3n,
    power: 5n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 70,
    aiRandomness: 15,
  },
  scorching_snap: {
    name: 'Scorching Snap',
    description: 'A whip-crack of flame lashes out, leaving smoldering welts.',
    castSeconds: 1n,
    cooldownSeconds: 14n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 60,
    aiRandomness: 15,
  },
  ember_spark: {
    name: 'Ember Spark',
    description: 'Tiny motes of fire burrow beneath the skin, burning from within.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 2n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 15,
  },
  searing_talon: {
    name: 'Searing Talon',
    description: 'White-hot claws rake across, leaving glowing furrows of pain.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  shadow_bleed: {
    name: 'Shadow Bleed',
    description: 'Dark energy seeps into wounds, turning blood to black ichor.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 65,
    aiRandomness: 15,
  },
  cinder_blight: {
    name: 'Cinder Blight',
    description: 'Choking ash and cinders smother and burn in equal measure.',
    castSeconds: 2n,
    cooldownSeconds: 16n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 55,
    aiRandomness: 15,
  },
  molten_bleed: {
    name: 'Molten Bleed',
    description: 'Liquid fire courses through open wounds, cauterizing nothing.',
    castSeconds: 3n,
    cooldownSeconds: 20n,
    kind: 'dot',
    magnitude: 4n,
    rounds: 3n,
    power: 5n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 70,
    aiRandomness: 15,
  },

  // Debuff abilities - physical damage
  crushing_gore: {
    name: 'Crushing Gore',
    description: 'A brutal horn strike that cracks armor and leaves you staggering.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'physical' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  quake_stomp: {
    name: 'Quake Stomp',
    description: 'The ground itself buckles underfoot, shattering defensive stances.',
    castSeconds: 2n,
    cooldownSeconds: 22n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'physical' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 20,
  },

  // Debuff abilities - magic damage
  sapping_chant: {
    name: 'Sapping Chant',
    description: 'A droning incantation drains vitality, leaving limbs heavy and slow.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  withering_hex: {
    name: 'Withering Hex',
    description: 'Cursed sigils etch into armor, weakening its protective wards.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 20,
  },
  mire_curse: {
    name: 'Mire Curse',
    description: 'Swamp magic seeps into joints, corroding metal and resolve.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  ember_slam: {
    name: 'Ember Slam',
    description: 'A concussive blast of flame hammers defenses into ruin.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 65,
    aiRandomness: 20,
  },
  chill_touch: {
    name: 'Chill Touch',
    description: 'Spectral cold numbs the body and brittles armor to cracking.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  grave_shield_break: {
    name: 'Grave Shield Break',
    description: 'Necrotic energy gnaws at protective enchantments, unraveling them.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },
  vault_crush: {
    name: 'Vault Crush',
    description: 'Ancient stone magic grinds against your guard, pulverizing defenses.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 70,
    aiRandomness: 20,
  },
  soot_hex: {
    name: 'Soot Hex',
    description: 'A choking hex of black soot blinds and weakens in equal measure.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 60,
    aiRandomness: 20,
  },

  // Heal abilities (new)
  shaman_heal: {
    name: 'Shaman Heal',
    description: 'Guttural chanting mends torn flesh with pulsing green light.',
    castSeconds: 2n,
    cooldownSeconds: 15n,
    kind: 'heal',
    power: 5n,
    healPowerSplit: 0.6,
    hotDuration: 3n,
    targetRule: 'lowest_hp',
    aiChance: 70,
    aiWeight: 80,
    aiRandomness: 10,
  },
  dark_mend: {
    name: 'Dark Mend',
    description: 'Shadow-stitched wounds knit together with an unnatural dark glow.',
    castSeconds: 3n,
    cooldownSeconds: 20n,
    kind: 'heal',
    power: 6n,
    healPowerSplit: 0.5,
    hotDuration: 2n,
    targetRule: 'lowest_hp',
    aiChance: 65,
    aiWeight: 75,
    aiRandomness: 10,
  },

  // AoE damage abilities (new)
  flame_burst: {
    name: 'Flame Burst',
    description: 'A roiling eruption of fire scorches everything nearby.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'aoe_damage',
    power: 6n,
    damageType: 'magic' as DamageType,
    targetRule: 'all_players',
    aiChance: 50,
    aiWeight: 75,
    aiRandomness: 15,
  },
  quake_wave: {
    name: 'Quake Wave',
    description: 'The earth splits and heaves, sending shockwaves through all who stand.',
    castSeconds: 3n,
    cooldownSeconds: 25n,
    kind: 'aoe_damage',
    power: 7n,
    damageType: 'physical' as DamageType,
    targetRule: 'all_players',
    aiChance: 45,
    aiWeight: 70,
    aiRandomness: 15,
  },

  // Night enemy abilities (quick-170)
  moth_dust: {
    name: 'Moth Dust',
    description: 'A cloud of stinging scales billows forth, irritating exposed skin.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 45,
    aiRandomness: 20,
  },
  plague_bite: {
    name: 'Plague Bite',
    description: 'Diseased fangs clamp down, injecting filth into the bloodstream.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 20,
  },
  spectral_flame: {
    name: 'Spectral Flame',
    description: 'Ghostly fire flickers to life, burning without heat but searing the soul.',
    castSeconds: 2n,
    cooldownSeconds: 16n,
    kind: 'dot',
    magnitude: 2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 55,
    aiRandomness: 15,
  },
  shadow_pounce: {
    name: 'Shadow Pounce',
    description: 'A blur of darkness slams into you, claws raking deep.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 2n,
    power: 4n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  drowning_grasp: {
    name: 'Drowning Grasp',
    description: 'Phantom water fills the lungs, choking without a drop in sight.',
    castSeconds: 2n,
    cooldownSeconds: 18n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 60,
    aiRandomness: 15,
  },
  soul_rend: {
    name: 'Soul Rend',
    description: 'A spectral claw tears at the essence within, fraying life force.',
    castSeconds: 2n,
    cooldownSeconds: 20n,
    kind: 'dot',
    magnitude: 3n,
    rounds: 3n,
    power: 4n,
    damageType: 'magic' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 50,
    aiWeight: 65,
    aiRandomness: 15,
  },
  venom_fang: {
    name: 'Venom Fang',
    description: 'Needle-thin fangs deliver a burning venom that spreads fast.',
    castSeconds: 1n,
    cooldownSeconds: 12n,
    kind: 'dot',
    magnitude: 1n,
    rounds: 2n,
    power: 2n,
    damageType: 'physical' as DamageType,
    dotPowerSplit: 0.5,
    targetRule: 'aggro',
    aiChance: 55,
    aiWeight: 50,
    aiRandomness: 20,
  },
  sonic_screech: {
    name: 'Sonic Screech',
    description: 'An ear-splitting shriek rattles bones and loosens armor straps.',
    castSeconds: 1n,
    cooldownSeconds: 14n,
    kind: 'debuff',
    effectType: 'ac_bonus',
    magnitude: -2n,
    rounds: 3n,
    power: 3n,
    damageType: 'magic' as DamageType,
    debuffPowerCost: 0.25,
    targetRule: 'aggro',
    aiChance: 45,
    aiWeight: 55,
    aiRandomness: 20,
  },

  // Buff abilities (new)
  warchief_rally: {
    name: 'Warchief Rally',
    description: 'A thundering war cry that emboldens every nearby ally.',
    castSeconds: 2n,
    cooldownSeconds: 30n,
    kind: 'buff',
    effectType: 'damage_bonus',
    magnitude: 3n,
    rounds: 5n,
    targetRule: 'all_allies',
    aiChance: 60,
    aiWeight: 70,
    aiRandomness: 15,
  },
  bolster_defenses: {
    name: 'Bolster Defenses',
    description: 'Dark magic hardens scales and toughens hides across the pack.',
    castSeconds: 2n,
    cooldownSeconds: 25n,
    kind: 'buff',
    effectType: 'armor_up',
    magnitude: 3n,
    rounds: 4n,
    targetRule: 'all_allies',
    aiChance: 55,
    aiWeight: 65,
    aiRandomness: 15,
  },
};

// Maps enemy template names to their ability keys.
// This is the single source of truth for which enemies have which abilities.
// Adding a new enemy ability requires: (1) add entry to ENEMY_ABILITIES above,
// (2) add template mapping here â€” both in this same file.
export const ENEMY_TEMPLATE_ABILITIES: Record<string, string[]> = {
  'Bog Rat': ['poison_bite'],
  'Ember Wisp': ['ember_burn'],
  'Bandit': ['bleeding_shot'],
  'Blight Stalker': ['shadow_rend'],
  'Grave Acolyte': ['sapping_chant', 'dark_mend'],
  'Hexbinder': ['withering_hex', 'warchief_rally'],
  'Thicket Wolf': ['rending_bite'],
  'Marsh Croaker': ['bog_slime'],
  'Dust Hare': ['quick_nip'],
  'Ash Jackal': ['scorching_snap'],
  'Thorn Sprite': ['thorn_venom'],
  'Gloom Stag': ['crushing_gore'],
  'Mire Leech': ['blood_drain'],
  'Fen Witch': ['mire_curse', 'shaman_heal'],
  'Grave Skirmisher': ['rusty_bleed'],
  'Cinder Sentinel': ['ember_slam', 'flame_burst'],
  'Emberling': ['ember_spark'],
  'Frostbone Acolyte': ['chill_touch'],
  'Ridge Skirmisher': ['stone_cleave'],
  'Emberhawk': ['searing_talon'],
  'Basalt Brute': ['quake_stomp', 'quake_wave'],
  'Grave Servant': ['grave_shield_break'],
  'Alley Shade': ['shadow_bleed'],
  'Vault Sentinel': ['vault_crush'],
  'Sootbound Mystic': ['soot_hex', 'bolster_defenses'],
  'Ember Priest': ['cinder_blight'],
  'Ashforged Revenant': ['molten_bleed'],
  // Night enemies (quick-170)
  'Dusk Moth': ['moth_dust'],
  'Night Rat': ['plague_bite'],
  'Cinder Wraith': ['spectral_flame'],
  'Shadow Prowler': ['shadow_pounce'],
  'Bog Specter': ['drowning_grasp'],
  'Ashveil Phantom': ['soul_rend'],
  'Nightfang Viper': ['venom_fang'],
  'Gloomwing Bat': ['sonic_screech'],
};
